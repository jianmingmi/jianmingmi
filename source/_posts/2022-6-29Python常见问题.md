---
title: Python常见问题
date: 2022-6-29
tags: [python]
---

Python常见问题

<!--more-->

## python和pip安装
```
python
    安装：sudo apt install python3

    运行
        python3 xxx.py
            -u：不带缓存输出
            -m：模块当做脚本运行
            -i：镜像源
            -c：允许cmd，例如：ssh -p 29418 jiajia1.tang@review.sonyericsson.net gerrit query --format=JSON --commit-message 784742  --current-patch-set | sed '2d' | python -c 'import json;import sys;print json.loads(sys.stdin.readline(),"UTF-8")["currentPatchSet"]["number"]'
pip
    安装：sudo apt install python3-pip

    查看所有库：pip3 list
    升级pip：pip3 install --upgrade pip
    安装库：pip3 install requests=[版本号] -i https://pypi.tuna.tsinghua.edu.cn/simple
    卸载并重装pip：sudo python3 -m pip uninstall pip && sudo apt install python3-pip --reinstall

库安装
    1.离线安装
        python install setup.py
    2.pip安装
        pip3 install requests=[版本号] -i https://pypi.tuna.tsinghua.edu.cn/simple
    3.idea安装
        Settings -> Project: script -> Project Interpreter
```

## 设置镜像源
```
ubuntu：
    vim ~/.pip/pip.conf
        [global]
        index-url = https://pypi.tuna.tsinghua.edu.cn/simple

windows：
    C:\Users\xxx\pip\pip.ini
        [global]
        index-url = https://pypi.tuna.tsinghua.edu.cn/simple
```

## Pycharm设置
```
Settings -> Editor -> File Encodings -> UTF-8
Settings -> Editor -> Code Style -> Tab size 改成 4
Settings -> Project: script -> Project Interpreter -> 设置python版本
Settings -> Project: script -> Project Interpreter -> 点+号，设置镜像源（https://pypi.tuna.tsinghua.edu.cn/simple）
```

## 生成包依赖
```
安装
    pip3 install pipreqs
生成
    pipreqs ./ --encoding=utf8
安装依赖
    pip3 install -r requirements.txt
```

## 虚拟环境
```
linux
    mkdir myproject
    cd myproject
    python3 -m venv venv
    . venv/bin/activate

windows
    mkdir myproject
    cd myproject
    py -3 -m venv venv
    venv\Scripts\activate
```

## 模块导入和使用
```
1. 在同一目录下:
    # 导入模块
        import support
    # 使用
        support.print_func('Runoob')
        print(support.count)

    # 导入模块内具体内容
        from support import print_func
        from support import count
    # 使用
        print_func('Runoob')
        print(count)

2. 子目录
    import os
    import sys
    sys.path.append(os.path.join(os.path.dirname(os.path.abspath(__file__)), 'sub_dir'))

3. 父目录
    import os
    import sys
    sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
```

## 默认解释器、编码
```
#!/usr/bin/python3
# encoding: utf-8
```

## Python引号
```
Python 可以使用引号( ' )、双引号( " )、三引号( ''' 或 """ ) 来表示字符串，其中三引号可以由多行组成。
word = 'word'
sentence = "这是一个句子。"
paragraph = """这是一个段落。
包含了多个语句"""
```

## is 与 == 区别
```
is 用于判断两个变量引用对象是否为同一个(同一块内存空间)， == 用于判断引用变量的值是否相等。
```

## 异常处理
```
捕获异常：
try:
    doxxx
except Exception as e:
    print(e)
    print(traceback.format_exc())

抛出异常：
raise Exception('haha')
```

## 全局变量
```
引用全局变量，不需要global声明，修改全局变量，需要使用global声明
```

## 解析参数
```
opts,args = getopt.getopt(sys.argv[1:],'hf:v',['help','filename=','version'])
for opt_name,opt_value in opts:
    if opt_name in ('-h','--help'):
        print("[*] Help info")
        sys.exit()
    if opt_name in ('-v','--version'):
        print("[*] Version is 0.01 ")
        sys.exit()
    if opt_name in ('-f','--filename'):
        fileName = opt_value
        print("[*] Filename is ",fileName)
        # do something
        sys.exit()
```


## wheel包
```
    安装
        pip3 install wheel
        pip3 install --upgrade setuptools

    setup.py
        from setuptools import setup

        setup(
            name='webscm',
            version='1.0',
            py_modules='webscm'
        )

    生成包
        python3 setup.py bdist_wheel

    导入包
        pip3 install webscm-1.0-py3-none-any.whl

    部署
        pip3 install waitress
        waitress-serve --call 'flaskr:create_app'
```

## url编码和解码
```
from urllib.parse import quote

# 将字符串‘程序设计’进行编码
text = quote("程序设计", 'utf-8')

# 对字符串‘%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1’进行解密
text = unquote("%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1", 'utf-8')
```

## 列表推导
```
list comprehensions
tmp_list = [var['file_name'] for var in LONG_SAVE_FILE_LIST]
```