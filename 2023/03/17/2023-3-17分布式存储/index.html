<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="&lt;p&gt;分布式存储&lt;/p&gt;"><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><title>分布式存储 | Mijm Blog</title><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Hexo 6.3.0"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-tags"><a class="post-tag-none-link" href="/tags/Linux/" rel="tag">Linux</a></div><div class="post-time">2023-03-17</div></div></div><div class="container post-header"><h1>分布式存储</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#DAS%E3%80%81SAN%E3%80%81NAS"><span class="toc-number">1.</span> <span class="toc-text">DAS、SAN、NAS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%97%E5%AD%98%E5%82%A8%E3%80%81%E6%96%87%E4%BB%B6%E5%82%A8%E5%AD%98%E3%80%81%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8"><span class="toc-number">2.</span> <span class="toc-text">块存储、文件储存、对象存储</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">3.</span> <span class="toc-text">分布式存储的优势</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Artifactory%E9%83%A8%E7%BD%B2"><span class="toc-number">4.</span> <span class="toc-text">Artifactory部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Minio%E9%83%A8%E7%BD%B2"><span class="toc-number">5.</span> <span class="toc-text">Minio部署</span></a></li></ol></details></div><div class="container post-content"><p>分布式存储</p>
<span id="more"></span>

<h2 id="DAS、SAN、NAS"><a href="#DAS、SAN、NAS" class="headerlink" title="DAS、SAN、NAS"></a>DAS、SAN、NAS</h2><ol>
<li><p>DAS(Direct Attached Storage)—直连式存储，就是拿一根线把存储设备直接连接到PC机或服务器上，那比如u盘，是用的接口把自身的存储设备直接和PC相连接，DAS有一定的缺点，如果你电脑只有一个卡槽或者一个USB接口，那只能仅限于哪一个卡槽或者USB接口的存储量，也叫说扩展性差</p>
</li>
<li><p>SAN(Storage Area Network)—存储区域网络，它呢，是通过网络进行连接存储的，在DAS中只能通过一根线或者移动硬盘来连接存储设备，这有点不能满足人们的需求，于是SAN就通过网络来连接存储设备，这样存储目标就广泛了起来，(这种网络现在可以是以太网了–ip)<br>DAS,SAN都属于块存储(下面讲解)。</p>
</li>
<li><p>NAS(Network Attached Storage)—网络附加存储，就是NAS需要通过网络来进行访问，只要是有网络来连接这个存储设备就行，它属于文件存储</p>
</li>
</ol>
<h2 id="块存储、文件储存、对象存储"><a href="#块存储、文件储存、对象存储" class="headerlink" title="块存储、文件储存、对象存储"></a>块存储、文件储存、对象存储</h2><ol>
<li><p>块存储：首先DAS，SAN都属于块存储<br>块存储就是块设备—-一切以磁盘的形式存在的存储就是块设备<br>a.块存储强调的是裸磁盘<br>b.所有以磁盘的形式直接提供给主机或服务器的设备都是块存储</p>
</li>
<li><p>文件存储—基于网络的共享文件存储<br>补充：文件系统：用来管理存储设备，和存储设备里面的数据，在主机终端去访问数据时不是直接访问的数据而是通过文件系统来进行对数据的查询，搜索…之后返回给中终端的。文件夹中有一级一级的目录对吧，那就是文件系统的功劳，有了文件系统数据目录才会有层次的展现给用户。<br>文件存储就是在块存储的前面加上了一层文件系统，对外提供存储服务，说白了就是，“块设备+文件系统”打包就是文件存储。结合下图演示：</p>
</li>
</ol>
<p><img src="/images/2023-3-17%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/1.png"></p>
<ol start="3">
<li><p>块存储和文件储存的优缺点<br>块存储：优点：读写速度快，可扩展性差，不易于共享<br>文件存储：优点：易于共享，读写速度慢</p>
</li>
<li><p>对象存储<br>对象存储就是一个全新的存储港式，它结合了块存储和文件存储的优点<br>特点：读写速度快，易于共享，扩展性强<br>对象存储和文件存储的文件系统完全不同，对象存储的文件系统时二层架构，文件存储用的传统的目录层结构的文件系统，就是在D盘建一个文件夹，在文件夹里面在建一个文件夹，然后在建文件夹等等，这就是目录结构的文件系统，那如果是这样，会降低存储的性能。</p>
</li>
</ol>
<p><img src="/images/2023-3-17%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8/2.png"></p>
<h2 id="分布式存储的优势"><a href="#分布式存储的优势" class="headerlink" title="分布式存储的优势"></a>分布式存储的优势</h2><ol>
<li>高可靠性：分布式存储有一个非常厉害的手段就是多时间点快照技术，可以让用户在一定的时间能够对各个版本数据进行备份，多时间点技术可以支持同时提取多个时间点的样本，并且能够在同一时间恢复数据。这项技术对于出现存储问题是非常有帮助的，并且避免存储问题产生的损失问题。多时间点快照为企业带来了非常可靠安心的数据安全保障。</li>
<li>高扩展性：分布式存储会对集群服务器进行扩展，让系统的存储容量、计算和性能的能力都得到提高。而有些企业因为业务量过大，对底层的分布式存储系统性能也会有所要求，分布式存储是具有合理的分布架构，可以帮助企业进行扩展弹性计算。</li>
<li>数据一致性：传统的存储架构使用RAID模式来保护数据的安全，而分布式存储则是用多副本备份的机制来保持数据一致性，在用户存储数据时，会对数据进行分片，把分片之后的数据在集群节点上保存。分布式存储采用的是一个副本写入，而其他的副本则是读取，在数据读取失败的时候，系统能从其他的副本中读取数据，并继续写入该副本，保证了副本总数的一致性，不过数据长时间处于不一致的情况，系统会自动重建和恢复，会将企业的业务影响降到最低。</li>
<li>高性能：分布式存储能够有效的管理读写缓存，能够自行分级存储。写缓存技术配合高速存储，能够使整体存储得到性能提高，将热点区域内的数据直接映射到高速存储中，这样可以更好的提高系统的响应速度。</li>
</ol>
<h2 id="Artifactory部署"><a href="#Artifactory部署" class="headerlink" title="Artifactory部署"></a>Artifactory部署</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">下载</span><br><span class="line">    https://jfrog.com/download-jfrog-platform/</span><br><span class="line">    https://www.jfrog.com/confluence/</span><br><span class="line">    https://www.jfrog.com/confluence/display/JFROG/Installing+Artifactory#InstallingArtifactory-DockerComposeInstallation</span><br><span class="line">docker安装</span><br><span class="line">    vim docker-compose.yml</span><br><span class="line">        version: &quot;3&quot;</span><br><span class="line">        services:</span><br><span class="line">          my_artifactory:</span><br><span class="line">            container_name: my_artifactory</span><br><span class="line">            image: releases-docker.jfrog.io/jfrog/artifactory-oss:latest</span><br><span class="line">            restart: always</span><br><span class="line">            ports:</span><br><span class="line">              - &quot;8081:8081&quot;</span><br><span class="line">              - &quot;8082:8082&quot;</span><br><span class="line">            volumes:</span><br><span class="line">              - ./artifactory:/var/opt/jfrog/artifactory</span><br><span class="line">              - /etc/localtime:/etc/localtime:ro</span><br><span class="line"></span><br><span class="line">artifactory-pro</span><br><span class="line">    vim docker-compose.yml</span><br><span class="line">        version: &quot;3&quot;</span><br><span class="line">        services:</span><br><span class="line">          my_artifactory:</span><br><span class="line">            container_name: my_artifactory</span><br><span class="line">            image: releases-docker.jfrog.io/jfrog/artifactory-pro:6.6.0</span><br><span class="line">            restart: always</span><br><span class="line">            ports:</span><br><span class="line">              - &quot;8081:8081&quot;</span><br><span class="line">              - &quot;8082:8082&quot;</span><br><span class="line">            volumes:</span><br><span class="line">              - ./artifactory:/var/opt/jfrog/artifactory</span><br><span class="line">              - /etc/localtime:/etc/localtime:ro</span><br><span class="line"></span><br><span class="line">    破解包</span><br><span class="line">        artifactory-injector-1.1.jar：https://gitee.com/g7go/chenjimblog/blob/master/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/data/artifactory/artifactory-injector-1.1.jar</span><br><span class="line">        移动文件至挂载目录 /opt/jfrog/artifactory</span><br><span class="line">        java -jar artifactory-injector-1.1.jar</span><br><span class="line">            【2】</span><br><span class="line">            【/opt/jfrog/artifactory】</span><br><span class="line">            【yes】</span><br><span class="line">            【1】</span><br><span class="line"></span><br><span class="line">初始账号密码：</span><br><span class="line">    admin/password</span><br></pre></td></tr></table></figure>

<h2 id="Minio部署"><a href="#Minio部署" class="headerlink" title="Minio部署"></a>Minio部署</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">官网</span><br><span class="line">    https://min.io/</span><br><span class="line">    http://minio.org.cn/</span><br><span class="line"></span><br><span class="line">普通安装</span><br><span class="line">    下载：wget https://dl.min.io/server/minio/release/linux-amd64/minio</span><br><span class="line">    将下载的文件变成可执行   chmod +x minio</span><br><span class="line">    启动：./minio server /data         不设置密码就是默认 minioadmin/minioadmin</span><br><span class="line"></span><br><span class="line">docker安装</span><br><span class="line">    vim docker-compose.yml</span><br><span class="line">        version: &quot;3&quot;</span><br><span class="line">        services:</span><br><span class="line">          my_minio:</span><br><span class="line">            container_name: my_minio</span><br><span class="line">            image: minio/minio</span><br><span class="line">            restart: always</span><br><span class="line">            ports:</span><br><span class="line">              - &quot;9000:9000&quot;</span><br><span class="line">              - &quot;9001:9001&quot;</span><br><span class="line">            volumes:</span><br><span class="line">              - ./data:/data</span><br><span class="line">              - /etc/localtime:/etc/localtime:ro</span><br><span class="line">            environment:</span><br><span class="line">              - MINIO_ROOT_USER=admin</span><br><span class="line">              - MINIO_ROOT_PASSWORD=admin123</span><br><span class="line">            command: server --console-address &#x27;:9001&#x27; /data</span><br><span class="line">            privileged: true</span><br><span class="line"></span><br><span class="line">用户权限设置</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">        &quot;Statement&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Effect&quot;: &quot;Allow&quot;,</span><br><span class="line">                &quot;Action&quot;: [</span><br><span class="line">                    &quot;s3:GetBucketLocation&quot;,</span><br><span class="line">                    &quot;s3:GetObject&quot;,</span><br><span class="line">                    &quot;s3:ListBucket&quot;</span><br><span class="line">                ],</span><br><span class="line">                &quot;Resource&quot;: [</span><br><span class="line">                    &quot;arn:aws:s3:::t5100a&quot;,</span><br><span class="line">                    &quot;arn:aws:s3:::t5100a/*&quot;</span><br><span class="line">                ]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">mc客户端下载</span><br><span class="line">    curl https://dl.min.io/client/mc/release/linux-amd64/mc -o mc</span><br><span class="line"></span><br><span class="line">mc客户端配置</span><br><span class="line">    mc config host add minio http://192.168.159.128:9000 admin admin123</span><br><span class="line"></span><br><span class="line">mc客户端使用</span><br><span class="line">    ls       列出文件和文件夹。</span><br><span class="line">    mb       创建一个存储桶或一个文件夹。</span><br><span class="line">    cat      显示文件和对象内容。</span><br><span class="line">    pipe     将一个STDIN重定向到一个对象或者文件或者STDOUT。</span><br><span class="line">    share    生成用于共享的URL。</span><br><span class="line">    cp       拷贝文件和对象。</span><br><span class="line">    mirror   给存储桶和文件夹做镜像。</span><br><span class="line">    find     基于参数查找文件。</span><br><span class="line">    diff     对两个文件夹或者存储桶比较差异。</span><br><span class="line">    rm       删除文件和对象。</span><br><span class="line">    events   管理对象通知。</span><br><span class="line">    watch    监视文件和对象的事件。</span><br><span class="line">    policy   管理访问策略。</span><br><span class="line">    config   管理mc配置文件。</span><br><span class="line">    update   检查软件更新。</span><br><span class="line">    version  输出版本信息。</span><br><span class="line"></span><br><span class="line">    参数信息：</span><br><span class="line">        --debug：调试</span><br><span class="line">        --json：输出json格式</span><br><span class="line">        --config-dir：配置文件路径</span><br><span class="line"></span><br><span class="line">    举例：</span><br><span class="line">        测试是否连通：mc admin info minio</span><br><span class="line">        创建桶或目录：mc mb minio/mybucket</span><br><span class="line">        文件列表：mc ls minio -r</span><br><span class="line">        文件拷贝：mc cp xxx.tgz minio/t5100a</span><br><span class="line">        文件删除或桶删除：mc rm minio/t5100a/xxx.tgz</span><br><span class="line">        列出文件共享列表：mc share list download minio</span><br><span class="line">        共享文件（无需key和secret key）：mc share download --expire 4h minio/t5100a/sign_key.tar.gz</span><br><span class="line">        镜像同步：mc mirror minio/t5100a .</span><br><span class="line">        文件查找：mc find minio --name &quot;*.tar.gz&quot;</span><br><span class="line">        比较文件：mc diff . minio/t5100a</span><br><span class="line">        显示公开的权限列表：mc anonymous list minio/t5100a</span><br><span class="line">        获取权限：mc anonymous get minio/t5100a</span><br><span class="line">        设置权限：mc anonymous set [none|download] minio/t5100a</span><br><span class="line"></span><br><span class="line">mc admin命令</span><br><span class="line">    service - 重新启动和停止所有MinIO服务器</span><br><span class="line">    update - 更新所有MinIO服务器</span><br><span class="line">    info - 显示MinIO服务器信息</span><br><span class="line">    user - 管理用户</span><br><span class="line">    group - 管理组</span><br><span class="line">    policy - 管理固定政策</span><br><span class="line">    config - 管理服务器配置文件</span><br><span class="line">    heal - 修复MinIO服务器上的磁盘，存储桶和对象</span><br><span class="line">    profile - 生成用于调试目的的配置文件数据</span><br><span class="line">    top - 为MinIO提供类似顶部的统计信息</span><br><span class="line">    trace - 显示MinIO服务器的http跟踪</span><br><span class="line">    console - 显示MinIO服务器的控制台日志</span><br><span class="line">    prometheus - 管理prometheus配置设置</span><br><span class="line"></span><br><span class="line">    举例：</span><br><span class="line">        测试是否连通：mc admin info minio</span><br><span class="line">        显示策略：mc admin policy list minio</span><br><span class="line">        mc admin user list minio</span><br><span class="line">        mc admin group list minio</span><br></pre></td></tr></table></figure></div></div><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/lato-font/3.0.0/css/lato-font.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcdn.net/ajax/libs/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcdn.net/ajax/libs/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>